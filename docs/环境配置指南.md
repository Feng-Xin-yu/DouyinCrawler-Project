# 环境配置指南

## 环境要求

- **Python**: 3.9.6 或更高版本
- **Node.js**: 16.0+ (用于执行JavaScript签名代码)
- **Redis**: (可选，如果使用 Redis 缓存)

## 安装步骤

### 步骤 1: 创建 Python 环境

**方式一：使用 Anaconda（推荐）**

```bash
# 创建 conda 环境
conda create -n DouyinCrawler python=3.9.6

# 激活环境
conda activate DouyinCrawler
```

**方式二：使用 Python venv**

```bash
# Windows
python -m venv venv
venv\Scripts\activate

# Linux/Mac
python3 -m venv venv
source venv/bin/activate
```

### 步骤 2: 进入项目目录

```bash
cd /d D:\DouyinCrawler-Project
```

### 步骤 3: 安装项目依赖

```bash
pip install -r requirements.txt
```

如果遇到安装问题，可以使用国内镜像源：
```bash
pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple
```

### 步骤 4: 验证安装

```bash
python --version
python -c "import httpx; import pydantic; import execjs; print('依赖安装成功')"
```

### 步骤 5: 配置账号信息

1. 打开 `config/accounts_cookies.xlsx` 文件
2. 在 `dy` 工作表中添加账号信息：
   - `account_name`: 账号名称
   - `cookies`: Cookie 字符串

**如何获取 Cookie**：
1. 打开浏览器，访问 https://www.douyin.com
2. 登录你的抖音账号
3. 按 F12 打开开发者工具
4. 切换到 Network（网络）标签
5. 刷新页面，找到任意请求
6. 在请求头中找到 `Cookie` 字段，复制其值

### 步骤 6: 配置爬虫参数

编辑 `config/base_config.py`，根据需要修改配置：

```python
# 爬取类型
CRAWLER_TYPE = "creator"

# 数据存储方式
SAVE_DATA_OPTION = "csv"

# 签名类型
SIGN_TYPE = "javascript"
```

## 启动爬虫

### 基本启动命令

**使用 Anaconda：**
```bash
conda activate DouyinCrawler
cd /d D:\DouyinCrawler-Project
python main.py --type creator
```

**使用 Python venv：**
```bash
# Windows
venv\Scripts\activate
cd /d D:\DouyinCrawler-Project
python main.py --type creator

# Linux/Mac
source venv/bin/activate
cd /path/to/DouyinCrawler-Project
python main.py --type creator
```

## 常见问题

### 问题 1: 找不到 execjs 模块

**错误信息**：`ModuleNotFoundError: No module named 'execjs'`

**解决方法**：
```bash
pip install PyExecJS==1.5.1
```

### 问题 2: JavaScript 运行时未安装

**错误信息**：`RuntimeError: execjs requires a JavaScript runtime`

**解决方法**：
- 安装 Node.js：https://nodejs.org/

### 问题 3: 找不到 accounts_cookies.xlsx

**解决方法**：
1. 在 `config/` 目录下创建 `accounts_cookies.xlsx` 文件
2. 创建一个名为 `dy` 的工作表
3. 添加列：`account_name` 和 `cookies`

### 问题 4: 依赖安装失败

**解决方法**：
1. 升级 pip：`pip install --upgrade pip`
2. 使用国内镜像源
3. 逐个安装依赖包

## 环境管理命令

**Anaconda 环境管理：**
```bash
# 查看所有 conda 环境
conda env list

# 激活环境
conda activate DouyinCrawler

# 退出环境
conda deactivate

# 删除环境
conda env remove -n DouyinCrawler
```

**Python venv 环境管理：**
```bash
# 激活环境
# Windows: venv\Scripts\activate
# Linux/Mac: source venv/bin/activate

# 退出环境
deactivate

# 删除环境（直接删除 venv 文件夹即可）
```
